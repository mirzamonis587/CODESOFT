$(function(){var n={init:function(){this.placeholder(),this.attach()},placeholder:function(){if(!(0<$(".istockphoto-placeholder").length)&&0!==$(".icon-grid").length){var e=$(".icon-grid .icon-preview"),t=Math.floor($(".icon-grid").width()/$(".icon-preview").width()),a=$(window).height()-$(".icon-grid").offset().top,i=Math.floor(a/$(".icon-preview").height()),r=Math.floor(e.length/t);i<6&&(i=6),r<i?i=r:i--;var o=t*i,n=$("<div />",{class:"istockphoto-placeholder d-block","data-phrase":$(".suggestions .new_query strong").text()||$("[data-phrase]").data("phrase")||$.url().param("q")||""});o>e.length&&(o=e.length);for(var s=0,c=0;c<e.length;c++)c%t==0&&0!=c&&s<6&&o<=c&&c%o==0&&(e.eq(c-1).after(n.clone()),s++)}},in_view:function(){if(0===$(".istockphoto-placeholder").length)return!1;var e=$(window).scrollTop(),t=$(window).height();return $(".istockphoto-placeholder").offset().top<=t+e},attach:function(){0!==$(".istockphoto-placeholder").length&&(n.in_view()?n.fetch():this.defer())},defer:function(){0!==$(".istockphoto-placeholder").length&&$(window).on("scroll.istock",function(){n.in_view()&&(n.fetch(),$(window).off("scroll.istock"))})},unique_indices:function(e){var a={};return e.forEach(function(e,t){a.hasOwnProperty(e.data.phrase)||(a[e.data.phrase]=t)}),Object.values(a)},search_data:function(r){var e=$(".istockphoto-placeholder").map(function(e,t){var a=$(t).data(),i={sort_order:a.sort_order||"best_match",phrase:a.phrase+" NOT sets NOT Silhouettes",graphical_styles:a.graphical_styles||"illustration,vector",exclude_nudity:"true",orientations:"square",page_size:a.page_size||96,fields:"summary_set,referral_destinations",include_related_searches:!0};return r&&(i.phrase=n.search_history()),{data:i,sharedid:a.sharedid}}),a=n.unique_indices(e.toArray());return e.map(function(e,t){return a.includes(e)?t:null})},search_history:function(){var e=localStorage.getItem("search_history");if(e){var t=JSON.parse(e);if(0<t.length&&"value"in t[0])return t[0].value}return!1},fetch:function(r){var e=n.search_data(r),o=1<e.length;e.each(function(a,i){$.ajax({url:"https://api.gettyimages.com/v3/search/images/creative",data:i.data,headers:{"Api-Key":"mumzxpc2xmrksfyv7fj9d2uz"},success:function(e){var t={phrase:i.data.phrase,sharedid:i.sharedid||"SRP"};t.images=$.map(e.images,function(e){return{thumbnail:_.findWhere(e.display_sizes,{name:"thumb"}),link:_.findWhere(e.referral_destinations,{site_name:"istockphoto"})}}),"related_searches"in e&&0<e.related_searches.length&&(t.related_searches=e.related_searches.slice(0,6)),t.images.length<3&&!r&&n.search_history()?n.fetch(!0):o?n.render(t,a):n.render(t)}})})},get_banner_template:function(e){return e.images.length<3?(ga("send","event","iStock","Show Banner","Fallback"),"ads/_istock_generic.html"):"ads/_istock.html"},render:function(a,e){if(full_list_of_images=a.images,size=24,void 0!==e){a.images=a.images.slice(0,size);var t=n.get_banner_template(a),i=templates.render(t,a);$(".istockphoto-placeholder").eq(e).html(i)}else $(".istockphoto-placeholder").each(function(e){a.images=full_list_of_images,a.images=a.images.slice(e*size,e*size+size);var t=templates.render(n.get_banner_template(a),a);$(this).html(t)});$('.istockphoto-banner [data-toggle="tooltip"]').tooltip()}};n.init(),$(document).on("search.results",function(){n.init()}),$(document).on("click",'[data-trigger="istock-popup"]',function(){var e=$.map({width:600,height:400,left:100,top:100,menubar:"no",toolbar:"no",location:"no",status:"no"},function(e,t){return t+"="+e}).join(",");window.open("/marketing/istock-code","Discount code",e)})});
//# sourceMappingURL=https://www.iconfinder.com/static/js/istock.js.map
