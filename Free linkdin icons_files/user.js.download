$(function(){$(document).on("remote.call.success","#notifications-item",function(e,n){renderModal("notifications/_modal",{notifications:n})});var n=function(){$.get("/notifications/ajax/unread_counter",function(e){var n=e.unread_counter||0;$(".notifications-count").text(n).toggleClass("d-none",n<=0)})};$(document).on("click",'[data-toggle="mark-as-read"]',function(){var e=$(this).data("target");$.post("/notifications/ajax/read/",{message_id:e},function(){n()})}),$(document).on("remote.call.success","[data-mark_all]",function(){n()})}),$(function(){$(document).on("keyup","#bookmark-form #search-collections",function(){var e=$("#bookmark-form"),t=$.trim($(this).val()).toLowerCase();e.find(".collection-name").each(function(){var e=$(this),n=-1==e.text().toLowerCase().indexOf(t);e.parents(".list-item").toggleClass("d-none",n)})}),$(document).on("show.bs.collapse hide.bs.collapse","#new-collection-form",function(e){var n="show"==e.type;n||$(this).removeClass("was-validated")[0].reset(),$('.modal-footer [data-toggle="collapse"][href="#new-collection-form"]').toggleClass("active",n)}),$(document).on("form.submit.success","#new-collection-form",function(e,n){n.collection.contains_element=!0;var t=templates.render("collections/_form_items.html",{collections:[n.collection]});$("#bookmark-form .collections-list").prepend(t),ga("send","event","Collections","Create","Collection created"),Intercom("trackEvent","collection-created"),$("#new-collection-form").collapse("hide")}),$(document).on("submit","#bookmark-form",function(e){var n=$(this).serializeObject();ga("send","event","Collections","Add",n.element_type+" added to collection(s)"),Intercom("trackEvent",n.element_type+"-added-to-collection")})}),$(function(){var e={base:{fontSize:"15px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif',lineHeight:"24px",color:"#495057","::placeholder":{color:"#6c757d"}},invalid:{color:"red"}},n=function(){stripeElements=stripe.elements(),card={},$("#cc-number").length&&(card.number=stripeElements.create("cardNumber",{placeholder:"Card number",style:e}),card.number.mount("#cc-number"),card.number.on("change",function(e){var n=$("#card-holder").attr("class");e.brand?e.brand!=n&&$("#card-holder").attr("class",e.brand):$("#card-holder").removeAttr("class")})),$("#cc-cvc").length&&(card.cvc=stripeElements.create("cardCvc",{placeholder:"CVC",style:e}),card.cvc.mount("#cc-cvc")),$("#cc-expiry").length&&(card.exp=stripeElements.create("cardExpiry",{placeholder:"MM / YY",style:e}),card.exp.mount("#cc-expiry"))};n(),$.fn.generateStripeToken=function(n){var t=this,o=$("body");t.parents(".modal-content").length&&(o=t.parents(".modal-content")),n=n||$.noop(),o.loading(!0,{title:"Validating card",description:"Please wait..."}),t.find(".payment-errors").addClass("d-none");var e={billing_details:{name:$("#cc-name").val()}};"user_billing_address"in window?e.billing_details.address=window.user_billing_address:e.billing_details.address={city:$("#id_address_city").val(),country:$("#id_address_country").val(),line1:$("#id_address_street").val(),postal_code:$("#id_address_postal_code").val(),state:$("#id_address_state").val()},stripe.createPaymentMethod("card",card.number,e).then(function(e){if(e.error)return o.loading(!1),void t.find(".payment-errors").text(e.error.message).removeClass("d-none");$("<input />",{type:"hidden",name:"payment_method_id",value:e.paymentMethod.id}).appendTo(t),n({token:e.paymentMethod.id})})};var r=function(e,n,t){var o={type:"danger",message:"Something went wrong while trying to add your credit card",autohide:!1};e.responseJSON&&(o.message=e.responseJSON.message),ga("send","event","Errors","Add card",o.message),n.find('[name="payment_method_id"]').remove(),t.loading(!1),$.notify(o)};$.fn.setupIntent=function(n,t){var o=$(this),e=o.serializeObject(),a=$("body");o.parents(".modal-content").length&&(a=o.parents(".modal-content")),t=t||$.noop(),$.ajax({url:"/commerce/ajax/setup-intent/",method:"POST",data:{payment_method_id:n,"g-recaptcha-response":e["g-recaptcha-response"]},success:function(e){"requires_action"==e.si_status?stripe.handleCardSetup(e.client_secret).then(function(e){if(e.error)return a.loading(!1),void o.find(".payment-errors").text(e.error.message).removeClass("d-none");t(n)}):t(n)},error:function(e){e.responseJSON&&e.responseJSON.errors&&"g-recaptcha-response"in e.responseJSON.errors?(o.recaptcha(e),a.loading(!1)):r(e,o,a)}})},$.fn.addCreditCardWithoutSetupIntent=function(n){var t=$(this),e=t.serializeObject(),o=$("body"),a=e.payment_method_id;if(t.parents(".modal-content").length&&(o=t.parents(".modal-content")),n=n||$.noop(),!a)return t.generateStripeToken(function(e){t.trigger("submit")}),!1;o.loading(!0,{title:"Saving card",description:"Please wait..."}),$.ajax({url:"/commerce/ajax/credit-cards/",method:"POST",data:{payment_method_id:a,payment_provider:"stripe"},success:function(e){$("<input />",{type:"hidden",name:"card",value:e.card_id}).appendTo(t),n(e)},error:function(e){r(e,t,o)}})},$.fn.addCreditCard=function(n){var t=$(this),e=t.serializeObject(),o=$("body"),a=e.payment_method_id;if(t.parents(".modal-content").length&&(o=t.parents(".modal-content")),n=n||$.noop(),!a)return t.generateStripeToken(function(e){t.trigger("submit")}),!1;o.loading(!0,{title:"Saving card",description:"Please wait..."}),t.setupIntent(a,function(e){$.ajax({url:"/commerce/ajax/credit-cards/",method:"POST",data:{payment_method_id:e,payment_provider:"stripe"},success:function(e){$("<input />",{type:"hidden",name:"card",value:e.card_id}).appendTo(t),n(e)},error:function(e){r(e,t,o)}})})},$(document).on("shown.bs.modal","#new-credit-card-modal",function(){n(),$("#add-credit-card").on("submit",function(e){var n=$(this);if(e.currentTarget.checkValidity())return n.addCreditCard(function(e){n.trigger("form.submit.success",e)}),!1})})}),$(function(){var t={"my-project-ended":{title:"My project ended",details:"Could you please let us know what type of project(s) you were working on?"},"needed-few-icons":{title:"I only needed a few icons/illustrations",details:"Could you please let us know what you were using icons for?"},pricing:{title:"Pricing",details:"Any suggestions about how we could improve our pricing to better suit your needs?"},"prefers-on-demand":{title:"I prefer buying on-demand (pay-as-you-go)",details:"Are you planning to use Iconfinderâ€™s Pay-As-You-Go service?",options:["Yes","No","I don't know"]},"missing-features":{title:"I am missing certain features",details:"What features would have made you stay?"},"another-service":{title:"I went for another service",details:"Out of curiosity, which service did you go for, and why?"},"could-not-find-icons":{title:"I couldn't find content I liked",details:"What kind of icons you were missing?"},"technical-problems":{title:"Technical problems",details:"What issues did you encounter?",support_link:!0},"did-not-know":{title:"I didn't know I was on a subscription"},"other-reason":{title:"Other reason",details:"Can you tell us more details?"}};$(document).on("remote.call.success",'[data-action="churn-survey"]',function(){var e=$(this).data();e.reasons=t,renderModal("churn-survey/_overview",e)}),$(document).on("form.submit.success","#churn-survey-overview",function(){var e=$(this).serializeObject(),n="churn-survey/_feedback";"details"in t[e.reason]&&(e=$.extend(e,t[e.reason]),n="churn-survey/_details"),renderModal(n,e)}),$(document).on("form.submit.success","#churn-survey-details",function(){var e=$(this).serializeObject();e=$.extend(e,t[e.reason]),renderModal("churn-survey/_feedback",e)}),$(document).on("form.submit.success","#churn-survey-feedback",function(){renderModal("churn-survey/_thank-you")}),$(document).on("click",'#feedback-form-modal [data-dismiss="modal"]',function(){location.reload()})}),$(function(){$(document).on("click",".billing-interval",function(){return"yearly"==$(this).attr("id")?($("#monthly").removeClass("border-purple text-purple"),$("#micro-monthly").addClass("d-none"),$("#yearly").addClass("border-purple text-purple"),$("#micro-yearly").removeClass("d-none"),$("#billinginterval").val("12")):($("#yearly").removeClass("border-purple text-purple"),$("#micro-yearly").addClass("d-none"),$("#monthly").addClass("border-purple text-purple"),$("#micro-monthly").removeClass("d-none"),$("#billinginterval").val("1")),!1})}),$(function(){$(document).on("change","#billing_account_type",function(){var e="business"==$(this).val();$("#id_company, #billing_vat").attr("disabled",!e)}),$(document).on("change","#family-form #is_premium",function(){var e="true"==$(this).val();$("#family-form #price").val(0).attr("readonly",!e)}),$(document).on("remote.call.success","[data-following]",function(e){var n=$(this),t=n.data(),o=$('[data-followers="'+t.username+'"]'),a="True"!=t.following,r=templates.render("profiles/_follow.html",{username:t.username,following:a,classes:n.attr("class")});if($('[data-following="'+t.following+'"][data-username="'+t.username+'"]').replaceWith(r),0<o.length){var i=Number(o.html().replace(",",""));o.html(a?i+1:i-1)}}),$(document).on("keyup","#billing_vat",function(e){var n=$(this),t=n.parents(".vat-validation"),o=$.trim(n.val()),a=!1;t.removeClass("warning success"),5<o.length&&(t.addClass("loading"),$.ajax({url:"/commerce/ajax/check-vat-number/",data:{vat_number:o},success:function(){a=!0},error:function(){a=!1},complete:function(){t.removeClass("loading").toggleClass("success",a).toggleClass("warning",!a)}}))}),$(document).on("change",'select[name="family"]',function(){"create"==$(this).val()&&($("#new-family").toggleClass("d-none"),$("#id_new_family").focus())}),$(document).on("click",'[data-action="connect-facebook"]',function(e){$("body").loading(!0),$.loadFacebookSDK(function(){FB.login(function(e){e.authResponse?$.post({url:"/user/ajax/social/facebook/connect",data:{access_token:e.authResponse.accessToken},success:function(e){location.reload()},error:function(e){"code"in e&&("already_connected"==e.code?alert("Another user is already connected with this Facebook account."):alert("Ooops! Something went wrong! Please try again.")),$("body").loading(!1)}}):$("body").loading(!1)},{scope:"email"})})}),$(document).on("pro.upgrade.prompt",function(e,n){renderModal("limiter/_upgrade-prompt",n),ga("send","event","User","Iconfinder Pro upgrade","All credits used")}),$(document).on("remote.call.success","#upgrade-plan",function(){$(this).data("amount");ga("send","event","Commerce","Plan upgrade","Amount",amount)}),$("body").on("remote.call.success",'[data-require="payment-confirmation"]',function(e,n){var t=$(this);if("requires_action"==n.pi_status)return e.stopImmediatePropagation(),$.confirmPayment(n.client_secret,function(e){t.data("payment_token",e.paymentIntent.id),t.removeAttr("data-confirm"),t.trigger("click")}),!1}),Cookies.get("recovery-modal")||$("body").hasClass("recovery-page")||($("#recovery-modal").detach().appendTo("body").modal("show"),$("#recovery-modal").on("click",".modal-footer .btn",function(){Cookies.set("recovery-modal","acted",{expires:7})}),$("#recovery-modal").on("hidden.bs.modal",function(){Cookies.set("recovery-modal","dismissed",{expires:7})})),$(document).on("load-success",function(e,n){"/user/navigation"==n.url&&$("#attention-needed").each(function(){var e=$(this),n=Base64.encode(e.data("hash"));e.find("a").on("click",function(e){e.preventDefault()}),e.popover({content:$("#attention-needed-content").html(),html:!0,animation:!1,placement:"bottom",sanitize:!1,template:$("#attention-needed-template").html()}),e.on("shown.bs.popover",function(){$(".nav-link").tooltip("hide"),$('[data-toggle="upgrade-prompt"]').on("remote.call.error",function(e,n){"responseJSON"in n&&"no_more_downloads_available"==n.responseJSON.code&&($(document).trigger("pro.upgrade.prompt",n.responseJSON),e.stopImmediatePropagation())}),$(document).one("show.bs.dropdown",function(){e.popover("hide")})}),$(window).on("load",function(){Cookies.get("needs_attention")!=n&&(e.trigger("click"),Cookies.set("needs_attention",n,{expires:7}))})})}),$(document).on("shown.bs.modal","#editor-upsell-modal",function(){$(this).find("video")[0].play()})});
//# sourceMappingURL=https://www.iconfinder.com/static/js/user.js.map
